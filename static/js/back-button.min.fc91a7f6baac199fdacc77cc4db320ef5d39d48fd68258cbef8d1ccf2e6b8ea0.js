(function(){"use strict";const e={savePageState:function(){const e={url:window.location.href,scrollY:window.scrollY,timestamp:Date.now()};sessionStorage.setItem("currentPageState",JSON.stringify(e))},restorePageState:function(){const e=sessionStorage.getItem("currentPageState");if(e)try{const t=JSON.parse(e);t.scrollY&&window.scrollTo(0,t.scrollY)}catch(e){console.warn("Failed to restore page state:",e)}},hasHistory:function(){return window.history.length>1||document.referrer!==""}},t={button:null,create:function(){return this.button=document.createElement("button"),this.button.className="back-button",this.button.innerHTML="<span>返回</span>",this.button.setAttribute("aria-label","返回上一页"),this.button.setAttribute("title","返回上一页"),this.button.addEventListener("click",this.handleClick.bind(this)),this.button},handleClick:function(t){t.preventDefault(),e.savePageState(),e.hasHistory()?window.history.back():window.location.href="/"},show:function(){this.button&&(this.button.style.display="flex")},hide:function(){this.button&&(this.button.style.display="none")},shouldShow:function(){const e=window.location.pathname==="/"||window.location.pathname==="/index.html";return!e}};function n(){if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",n);return}const o=t.create();document.body.appendChild(o),t.shouldShow()?t.show():t.hide();let s;window.addEventListener("scroll",function(){clearTimeout(s),s=setTimeout(function(){e.savePageState()},100)}),window.addEventListener("beforeunload",function(){e.savePageState()}),window.addEventListener("popstate",function(){setTimeout(function(){e.restorePageState()},100)}),setTimeout(function(){e.restorePageState()},100)}n()})()